<%= render 'shared/navbar_pages' %>
<div class="container">
  <div class="card-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3))">
    <div class="d-flex justify-content-between align-items-center">
    <div class="d-flex flex-column align-content-center">
        <h1 class="h1-allivu my-0"><%= "Hello #{current_user.first_name}"%></h1>
        <p class="my-0">Joined in <%= "#{current_user.created_at.year}" %></p>
    <% if current_user.user_reviews.any? %>
      <h6><%= "#{current_user.user_reviews.count} Reviews" %></h6>
    <% end %>
      </div>
    <%= render 'avatar_photo' %>
    </div>
    <p>-----------------------------------------------</p>
      <!-- Review Overview -->
      <% @user_services = current_user.services %>
      <% array = [] %>
      <% @user_services.each do |service| %>
        <% array << service.reviews.count %>
      <% end %>
      <% if @user_services.empty? %>
        <p><%= "No Reviews yet" %></p>
      <% else %>
        <p><%= "#{array.sum} Reviews" %></p>
        <p><%= "Average rating:  #{'%.1f' % (array.sum(0.0) / array.size)}" %> &#9733</p>
      <% end %>
  </div>
  <p>-----------------------------------------------</p>
  <!-- Upcoming bookings -->
  <%= render 'provider_bookings' %>
  <p>-----------------------------------------------</p>

  <!-- Review feed -->
  <%= render 'review_feed' %>
  <p>-----------------------------------------------</p>

  <!-- Return to profile button -->
  <div class="d-flex justify-content-center my-5">
    <%= link_to "Back to profile", user_path, class: "button-wide" %>
  </div>
</div>
